<form action="<?php echo $this->element->getAction();?>"       method="<?php echo $this->element->getMethod();?>"      enctype="<?php echo $this->element->getAttrib('enctype');?>">    <div>        <?php echo $this->element->searchCliente ?>    </div>    <div id="actionViewModal"> Nuevo Cliente </div>    <span id="autocompleteCliente" style="position: absolute; background-color: #009ede;">    </span>    <input type="hidden" value="" id="idcliente" name="idcliente">    <div id="tableSeachCLiente"></div>    <div>        <?php echo $this->element->searchArticulo ?>        <div id="tableSeachArticulo">        </div>        <span id="autocompleteArticulo" style="position: absolute; background-color: #009ede;">        </span>    </div>    <table id="tableArticulo" class="sticky-enabled tableSelect-processed sticky-table">        <thead class="tableHeader-processed">            <tr>                <th>Nombre</th>                <th>Descripción</th>                <th>Precio</th>                <th>Cantidad</th>                <th>Total</th>            </tr>        </thead>        <tbody>        </tbody>        <tr>            <td> </td>            <td> </td>            <td> </td>            <td style="color: red; font-weight: bold"> Total General </td>            <td style="color: red; font-weight: bold"> <span id="total">0</span></td>            <td> </td>        </tr>    </table>    <table style="width: 700px;">        <tr>            <td class="3">        <?php echo $this->element->direccion ?>            </td>        </tr>        <tr>            <td>        <?php echo $this->element->fechaEntrega ?>                            </td>            <td>            <?php echo $this->element->hora ?>            <?php echo $this->element->minuto ?>            </td>            <td>            </td>        </tr>        <tr>            <td>        <?php echo $this->element->tipoDocumento ?>            </td>            <td>        <span id="spanNumSerie">            <?php echo $this->element->numSerie ?>        </span>            </td>            <td>        <?php echo $this->element->numComprobante ?>            </td>        </tr>    </table>            <div>        <?php echo $this->element->informacionAdicional ?>    </div>    <div>        <?php echo $this->element->searchTextResponsable ?>        <span id="responsableSearch" style="position: absolute; background-color: #009ede;">        </span>        <span id="responsable"></span>    </div>     <div>         <?php echo $this->element->enviar ?>        <?php echo $this->element->cancelar ?>    </div></form><div id="dialog-form" title="Ingresar Nuevo Usuario">	<p class="validateTips">Todos estos campos son requeridos.</p>        <?php echo $this->element->getView()->formularioCliente; ?></div><script type="text/javascript">    $(function() {        $('#numSerie').live('change',function(){            $.ajax({                data: "idTipoComprobante="+this.value,                type: "POST",                dataType: "json",                url: "/admin/pedidos/ajax-generar-num-comprobante",                success: function(data){ }            });        })        $('#tipoDocumento').change(function(){            $.ajax({                data: "idTipoComprobante="+this.value,                type: "POST",                dataType: "json",                url: "/admin/pedidos/ajax-listar-numero-serie",                success: function(data){                     var contenido ='<select id="numSerie" name="numSerie">';                        contenido = contenido + '<option value="">---</option>';                    for (var i = 0; i < data.length; i++) {                         contenido = contenido + '<option value="'+ data[i]['serie'] +'">'+ data[i]['serie'] +'</option>';                    }                    contenido = contenido + '</select>';                    $('#numSerie-element').empty();                    $('#numSerie-element').append(contenido);                }            });        });       // $('#actionViewModal').click(function(){        //    $("#modalView").attr('class','modalActive');         //});        $("#searchTextResponsable").keypress(function(e) {            if(e.which == 13){                e.preventDefault();                searchResponsable(this.value);            }         });            $( "#searchCliente" ).keypress(function(e) {            if(e.which == 13){                e.preventDefault();                var valor = this.value;                       $.ajax({                    data: "searchCliente="+valor,                    type: "POST",                    dataType: "json",                    url: "/admin/pedidos/ajax-search-clientes",                    success: function(data){                         $('#autocompleteCliente').empty();                         var contenido='';                        contenido = '<div><table>';                        for (var i = 0; i < data.length; i++) {                             contenidoHidden = '<table class="sticky-enabled tableSelect-processed sticky-table">';                            contenidoHidden = contenidoHidden +'<thead class="tableHeader-processed">';                            contenidoHidden = contenidoHidden +'<tr>';                            contenidoHidden = contenidoHidden +'<th>Nombre</th>';                            contenidoHidden = contenidoHidden +'<th>Apellidos</th>';                            contenidoHidden = contenidoHidden +'<th>Ruc</th>';                            contenidoHidden = contenidoHidden +'<th>Dirección</th>';                            contenidoHidden = contenidoHidden +'<th>Telefonos</th>';                            contenidoHidden = contenidoHidden +'<th>Dni</th>';                            contenidoHidden = contenidoHidden +'</tr>';                            contenidoHidden = contenidoHidden +'</thead>';                            contenidoHidden = contenidoHidden +'<tbody>';                            contenidoHidden = contenidoHidden +'<tr>';                            contenidoHidden = contenidoHidden +'<td>'+data[i]['nombre']+'</td>';                            contenidoHidden = contenidoHidden +'<td>'+data[i]['apellidomaterno']+ ' ' +data[i]['apellidopaterno']+'</td>';                            contenidoHidden = contenidoHidden +'<td>'+data[i]['ruc']+ '</td>';                            contenidoHidden = contenidoHidden +'<td>'+data[i]['direccion']+ '</td>';                            contenidoHidden = contenidoHidden +'<td>'+data[i]['telefono1']+ ' - ' +data[i]['telefono2']+ ' - ' +data[i]['movil']+'</td>';                            contenidoHidden = contenidoHidden +'<td>'+data[i]['dni']+ '</td>';                            contenidoHidden = contenidoHidden +'</tr>';                            contenidoHidden = contenidoHidden +'</tbody>';                            contenidoHidden = contenidoHidden + '</table>';                            contenido = contenido + '<tr style="cursor:pointer" name="asa" id="itemCliente-'+data[i]['idcliente']+'">';                            contenido = contenido + '<td>';                            contenido = contenido + "<input type='hidden' id='itemHiddenCliente-"+data[i]['idcliente']+"'   value='"+contenidoHidden+"' >";                            contenido = contenido + data[i]['nombre'];                            contenido = contenido + '</td>';                            contenido = contenido + '<td>';                            contenido = contenido + data[i]['apellidomaterno'] +' '+ data[i]['apellidopaterno'];                            contenido = contenido + '</td>';                            contenido = contenido + '</tr>';                        }                        contenido = contenido + '</table></div>';                        $('#autocompleteCliente').append(contenido);                    }                });            }        })	        $( "#searchArticulo" ).keypress(function(e) {            if(e.which == 13){                e.preventDefault();                var valor = this.value;                       $.ajax({                    data: "searchArticulo="+valor,                    type: "POST",                    dataType: "json",                    url: "/admin/pedidos/ajax-search-articulos",                    success: function(data){                        $('#autocompleteArticulo').empty();                         var contenido='';                        var contenidoHidden='';                        contenido = '<div><table>';                        for (var i = 0; i < data.length; i++) {                             contenidoHidden = contenidoHidden +'<tr id="row_'+data[i]['idarticulo']+'">';                            contenidoHidden = contenidoHidden +'<td>'+data[i]['nomArticulo']+'<input type="hidden" name="idarticulo[]" value="'+data[i]['idarticulo']+'" id="idarticulo_'+data[i]['idarticulo']+'"></td>';                            contenidoHidden = contenidoHidden +'<td>'+data[i]['descArticulo']+'</td>';                            contenidoHidden = contenidoHidden +'<td><input name="precio[]" id="precio_'+data[i]['idarticulo']+'" type="text" value="'+parseFloat(data[i]['precioventa'])+'"></td>';                            contenidoHidden = contenidoHidden +'<td><input name="cantidad[]" id="cantidad_'+data[i]['idarticulo']+'" type="text" value="1"></td>';                            contenidoHidden = contenidoHidden +'<td><input name="total[]" id="total_'+data[i]['idarticulo']+'"  disabled="disabled" type="text" value="0"></td>';                            contenidoHidden = contenidoHidden +'<td>[<a id="eliminarArti-'+data[i]['idarticulo']+'" href="#">Eliminar</a>]</td>';                            contenidoHidden = contenidoHidden +'</tr>';                            contenido = contenido + '<tr style="cursor:pointer" id="itemArticulo-'+data[i]['idarticulo']+'">';                            contenido = contenido + "<td><input type='hidden' value='"+contenidoHidden+"' id='itemArticuloHide-"+data[i]['idarticulo']+"'>";                            contenido = contenido + data[i]['nomArticulo'];                            contenido = contenido + '</td>';                            contenido = contenido + '</tr>';                            contenidoHidden='';                        }                        contenido = contenido + '</table></div>';                        $('#autocompleteArticulo').append(contenido);                    }                });            }        })        $("[id^=itemCliente]").live("click",function(){            var idClienteArray = this.id.split('-');            contenValueHiden = $("#itemHiddenCliente-"+idClienteArray[1]).attr('value');            mostrarCLiente(contenValueHiden,idClienteArray[1]);        });        $("[id^=itemResponsable]").live("click",function(){            var idClienteArray = this.id.split('-');            mostrarResponsable(idClienteArray[1]);        });            $("[id^=itemArticulo]").live("click",function(){           var idClienteArray = this.id.split('-');            contenValueHiden = $("#itemArticuloHide-"+idClienteArray[1]).attr('value');            mostrarArticulo(contenValueHiden,idClienteArray[1]);        });            $("[id^=eliminarArti]").live("click",function(){            var idArticuloArray = this.id.split('-');            $(this).parent().parent().remove();            eliminaArticulo(idArticuloArray[1]);            totalProductos();        });        function mostrarResponsable(idusuario){            $.ajax({                data: "idusuario="+idusuario,                type: "POST",                dataType: "json",                url: "/admin/pedidos/ajax-get-responsable",                success: function(data){                    var contenido='';                    var nombre = data['apellidomaterno'];                    nombre = nombre + ' ' + data['apellidopaterno'];                    nombre = nombre + ' ' + data['nombre'];                    contenido = nombre+'<input type="hidden" id="idusuario" value='+idusuario+'>';                    $('#responsable').empty();                     $('#responsableSearch').empty();                     $('#responsable').append(contenido);                            }            });        }        function eliminaArticulo(idArticulo){            $.ajax({                data: "idArticulo="+idArticulo,                type: "POST",                dataType: "json",                url: "/admin/pedidos/ajax-delete-articulo",                success: function(data){}            });        }        function mostrarArticulo(contenido,idArticulo){            $('#autocompleteArticulo').empty();             $('#tableArticulo tr:first').after(contenido);            totalItem(idArticulo);                $.ajax({                data: "idArticulo="+idArticulo,                type: "POST",                dataType: "json",                url: "/admin/pedidos/ajax-get-articulo",                success: function(data){}            });        }        $("[id^=precio_]").live("keyup",function(e){            var splitId = this.id.split('_');            totalItem(splitId[1]);        });        $("[id^=cantidad_]").live("keyup",function(e){            var splitId = this.id.split('_');            totalItem(splitId[1]);        });        function totalProductos(){            var total =0;            $("[id^=idarticulo_]").each(function(){                var splitId = this.id.split('_');                total = total + parseFloat($('#total_'+splitId[1]).attr('value'));            });            $('#total').empty();             $('#total').append(total);        }        function totalItem(idArticulo){            $('#total_'+idArticulo).attr('value',parseFloat($('#precio_'+idArticulo).attr('value'))*parseFloat($('#cantidad_'+idArticulo).attr('value')));            totalProductos();        }        function searchResponsable(textSearch){            $.ajax({                data: "buscarResponsable="+textSearch,                type: "POST",                dataType: "json",                url: "/admin/pedidos/ajax-search-responsable",                success: function(data){                    var contenido='';                    contenido = '<div><table>';                    for (var i = 0; i < data.length; i++) {                         var nombre = data[i]['apellidomaterno'];                        nombre = nombre + ' ' + data[i]['apellidopaterno'];                        nombre = nombre + ' ' + data[i]['nombre'];                        contenido = contenido + '<tr style="cursor:pointer" name="asa" id="itemResponsable-'+data[i]['idusuario']+'">';                        contenido = contenido + '<td>';                        contenido = contenido + nombre;                        contenido = contenido + '</td>';                        contenido = contenido + '</tr>';                    }                    contenido = contenido + '</table></div>';                    $('#responsableSearch').empty();                     $('#responsableSearch').append(contenido);                }            });        }        function mostrarCLiente(contenido,idcliente){            $('#tableSeachCLiente').empty();             $('#idcliente').attr('value',idcliente);             $('#tableSeachCLiente').append(contenido);            $('#autocompleteCliente').empty();         }    });	$(function() {                $( "#dialog:ui-dialog" ).dialog( "destroy" );                var nombre          = $( "#nombre" );                    apellidopaterno = $( "#apellidopaterno" );                    apellidomaterno = $( "#apellidomaterno" );                    correo          = $( "#correo" );                    //direccion       = $( "#direccion" ),                    allFields = $( [] ).add(nombre).add( apellidopaterno ).add( apellidomaterno).add( correo );//.add( direccion ),                    tips = $( ".validateTips" );                function updateTips( t ) {			tips				.text( t )				.addClass( "ui-state-highlight" );			setTimeout(function() {				tips.removeClass( "ui-state-highlight", 1500 );			}, 500 );		}		function checkLength( o, n, min, max ) {			if ( o.val().length > max || o.val().length < min ) {				o.addClass( "ui-state-error" );				updateTips( "Las letras del " + n + " deben estar entre " +					min + " y " + max + "." );				return false;			} else {				return true;			}		}		function checkRegexp( o, regexp, n ) {			if ( !( regexp.test( o.val() ) ) ) {				o.addClass( "ui-state-error" );				updateTips( n );				return false;			} else {				return true;			}		}				$( "#dialog-form" ).dialog({			autoOpen: false,			height: 500,			width: 550,			modal: true,			buttons: {				"Crear Usuario": function() {                                var bValid = true;                                allFields.removeClass( "ui-state-error" );                                bValid = bValid && checkLength( nombre, "nombre", 3, 20 );                                bValid = bValid && checkLength( apellidopaterno, "apellidopaterno", 3, 20 );                                bValid = bValid && checkLength( apellidomaterno, "apellidomaterno", 3, 16 );                                //bValid = bValid && checkLength( direccion, "direccion", 3, 16 );                                bValid = bValid && checkLength( correo, "correo", 6, 80 );                                                                bValid = bValid && checkRegexp(nombre, /^[a-z]([0-9a-z_])+$/i, "nombre debe tener  a-z, 0-9, subraya, comenzar con una letra." );                                bValid = bValid && checkRegexp(apellidopaterno, /^[a-z]([0-9a-z_])+$/i, "Apellido Paterno debe tener  a-z, 0-9, subraya, comenzar con una letra." );                                bValid = bValid && checkRegexp(apellidomaterno, /^[a-z]([0-9a-z_])+$/i, "Apellido Materno tener  a-z, 0-9, subraya, comenzar con una letra." );                                //bValid = bValid && checkRegexp(direccion, /^[a-z]([0-9a-z_])+$/i, "direccion debe tener  a-z, 0-9, subraya, comenzar con una letra." );                                // From jquery.validate.js (by joern), contributed by Scott Gonzalez: http://projects.scottsplayground.com/email_address_validation/                                bValid = bValid && checkRegexp( correo, /^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i, "eg. ui@jquery.com" );                                    if ( bValid ) {                                                                                        fn_agregar();                                            $(this).dialog( "close" );                                    }                                                                    },                                Cancel: function() {					$( this ).dialog( "close" );				}			},			close: function() {				allFields.val( "" ).removeClass( "ui-state-error" );			}		});		$( "#actionViewModal" )			.button()			.click(function() {				$( "#dialog-form" ).dialog( "open" );			});                });	function fn_agregar(){		var str = $("#form_cliente").serialize();		$.ajax({			url: 'pedidos/nuevo-cliente-ajax',                        data: str,			type: 'post',                        success: function(data){				if(data != ""){                                    //alert(data['data2']['nombre']);                                       $("#tableSeachCLiente").append(' nombre: ' + data['data2']['nombre']  + ' Apellidos: ' + data['data2']['apellidopaterno']+ ' ' + data['data2']['apellidomaterno'] + ' Telefono: ' + data['data2']['telefono1']);                                }                        }        	});	};        </script>